# Markdown文章编辑功能说明

## 📦 安装依赖

在 `ltbot` 项目目录下执行：

```bash
npm install md-editor-v3 --save
```

## ✨ 功能概述

### 1. 写文章功能
- **入口**: 博客页面右上角"写文章"按钮
- **编辑器**: 使用 `md-editor-v3` 专业Markdown编辑器
- **功能特性**:
  - ✅ 实时预览
  - ✅ 富文本工具栏（粗体、斜体、标题、列表等）
  - ✅ 代码高亮
  - ✅ 大纲导航（catalog）
  - ✅ 全屏/页面全屏模式
  - ✅ 支持表格、链接、图片
  - ✅ 支持Mermaid流程图
  - ✅ 支持数学公式（KaTeX）

### 2. 文章管理
- **暂存草稿**: 点击"暂存草稿"按钮保存到localStorage
- **发布文章**: 点击"发布文章"，填写分类、标签、封面后发布
- **自动保存**: 每30秒自动保存草稿到localStorage
- **编辑草稿**: 从"我的"tab页可以继续编辑草稿

### 3. 我的文章
- **新增Tab**: 博客页面新增"我的"标签页
- **草稿列表**: 显示所有暂存的草稿（带"草稿"标识）
- **已发布列表**: 显示所有已发布的文章
- **点击操作**:
  - 草稿 → 跳转编辑器继续编辑
  - 已发布文章 → 查看文章详情

## 📁 文件结构

```
packages/ltbot/src/
├── views/
│   └── blog/
│       ├── index.vue          # 博客列表页（已更新）
│       └── editor.vue         # 文章编辑器（新增）
└── router/
    └── routers/
        └── modules/
            └── blog/
                └── blog.ts    # 路由配置（已更新）
```

## 🎨 UI设计特点

### 编辑器页面
- **顶部操作栏**:
  - 返回按钮（带确认提示）
  - 文章标题输入框
  - 暂存草稿按钮
  - 发布文章按钮

- **编辑器区域**:
  - 左侧：Markdown源码编辑
  - 右侧：实时预览
  - 工具栏：丰富的格式化工具
  - 大纲：快速导航

### 博客列表页
- **新增元素**:
  - 右上角"写文章"按钮（蓝色主题）
  - "我的"标签页
  - 草稿文章带黄色"草稿"标识

## 💾 数据存储

### localStorage keys:
1. `article_drafts` - 草稿列表
   ```json
   [{
     "id": "1234567890",
     "title": "文章标题",
     "content": "Markdown内容",
     "category": "前端",
     "tags": ["Vue3", "TypeScript"],
     "image": "封面图URL",
     "status": "draft",
     "createdAt": "2024-01-20T10:00:00.000Z",
     "updatedAt": "2024-01-20T10:30:00.000Z"
   }]
   ```

2. `article_published` - 已发布文章列表
   ```json
   [{
     "id": "1234567890",
     "title": "文章标题",
     "content": "Markdown内容",
     "summary": "文章摘要",
     "category": "前端",
     "tags": ["Vue3", "TypeScript"],
     "image": "封面图URL",
     "author": "kim",
     "date": "2024/1/20",
     "views": 0,
     "likes": 0,
     "status": "published",
     "publishedAt": "2024-01-20T10:00:00.000Z"
   }]
   ```

3. `article_auto_save` - 自动保存的临时数据
   ```json
   {
     "title": "文章标题",
     "content": "Markdown内容",
     "timestamp": 1234567890000
   }
   ```

## 🚀 使用流程

### 写新文章
1. 点击博客页右上角"写文章"按钮
2. 输入文章标题
3. 在编辑器中编写Markdown内容
4. 可随时点击"暂存草稿"保存
5. 完成后点击"发布文章"
6. 填写分类、标签、封面图
7. 确认发布

### 编辑草稿
1. 切换到"我的"tab页
2. 找到要编辑的草稿（带"草稿"标识）
3. 点击草稿卡片
4. 继续编辑并发布或暂存

### 查看已发布文章
1. 切换到"我的"tab页
2. 查看已发布的文章列表
3. 点击文章查看详情

## 🎯 技术栈

- **Vue 3** - 组合式API
- **TypeScript** - 类型安全
- **md-editor-v3** - Markdown编辑器
- **原生HTML/CSS** - 弹窗和表单（无需第三方UI库）
- **Vue Router** - 路由管理
- **localStorage** - 本地数据持久化

## 📝 注意事项

1. **数据持久化**: 所有文章数据存储在localStorage，清除浏览器数据会丢失
2. **自动保存**: 编辑器每30秒自动保存一次，防止意外丢失内容
3. **离开提示**: 如有未保存内容，点击返回会提示确认
4. **封面图片**: 需提供图片URL，建议使用图床服务
5. **文章摘要**: 发布时自动截取前200字符作为摘要

## 🔧 后续优化建议

1. **后端集成**: 替换localStorage为真实API调用
2. **图片上传**: 集成图床服务，支持拖拽上传
3. **文章搜索**: 在"我的"页面添加搜索功能
4. **文章分类管理**: 支持自定义分类
5. **Markdown导入导出**: 支持本地.md文件导入导出
6. **版本历史**: 保存文章编辑历史记录
7. **协作编辑**: 支持多人协作编辑
8. **文章统计**: 添加字数统计、阅读时间预估

## 📸 功能截图路径

- 编辑器页面: `/blog/editor`
- 博客列表页: `/blog`
- 我的文章: `/blog?tab=mine`

